if (self.CavalryLogger) { CavalryLogger.start_js(["hAb+U"]); }

__d("CommentPostedLiveState",[],(function a(b,c,d,e,f,g){f.exports={LIVE:"Live",ON_DEMAND:"OnDemand"};}),null);
__d("FBFeedLocations",[],(function a(b,c,d,e,f,g){f.exports={NEWSFEED:1,GROUP:2,GROUP_PERMALINK:3,COMMUNITY:4,PERMALINK:5,SHARE_OVERLAY:6,PERMALINK_STREAM:7,GROUP_PINNED:8,FRIEND_LIST:9,TIMELINE:10,HASHTAG_FEED:11,TOPIC_FEED:12,PAGE:13,NOTIFICATION_FEED:14,GROUP_REPORTED:15,GROUP_PENDING:16,PAGES_FEED_IN_PAGES_MANAGER:17,TICKER_CLASSIC:18,PAGES_SUGGESTED_FEED_IN_PAGES_MANAGER:19,SEARCH:20,GROUP_SEARCH:21,NO_ATTACHMENT:22,EMBED:23,EMBED_FEED:24,ATTACHMENT_PREVIEW:25,STORIES_TO_SHARE:26,PROMPT_PERMALINK:27,TREND_HOVERCARD:28,OPEN_GRAPH_PREVIEW:30,HOTPOST_IN_PAGES_FEED:31,SCHEDULED_POSTS:32,TIMELINE_NOTES:33,PAGE_INSIGHTS:34,COMMENT_ATTACHMENT:35,PAGE_TIMELINE:36,GOODWILL_THROWBACK_PERMALINK:37,LIKE_CONFIRM:39,GOODWILL_THROWBACK_PROMOTION:40,BROWSE_CONSOLE:42,GROUP_FOR_SALE_COMPACT:43,ENTITY_FEED:44,GROUP_FOR_SALE_DISCUSSION:45,PAGES_CONTENT_TAB_PREVIEW:46,GOODWILL_THROWBACK_SHARE:47,TIMELINE_VIDEO_SHARES:48,EVENT:49,PAGE_PLUGIN:50,SRT:51,PAGES_CONTENT_TAB_INSIGHTS:52,ADS_PE_CONTENT_TAB_INSIGHTS:53,PAGE_ACTIVITY_FEED:54,VIDEO_CHANNEL:55,POST_TO_PAGE:56,GROUPS_GSYM_HOVERCARD:57,GROUP_POST_TOPIC_FEED:58,FEED_SURVEY:59,PAGES_MODERATION:60,SAVED_DASHBOARD:61,PULSE_SEARCH:62,GROUP_NUX:63,GROUP_NUX_POST_VIEW:64,EVENT_PERMALINK:65,FUNDRAISER_PAGE:66,EXPLORE_FEED:67,CRT:68,REVIEWS_FEED:69,VIDEO_HOME_CHANNEL:70,NEWS:71,TIMELINE_FRIENDSHIP:72,SAVED_REMINDERS:73,PSYM:74,ADMIN_FEED:75,CAMPFIRE_NOTE:76,PAGES_CONTEXT_CARD:77,ACTIVITY_LOG:78,WALL_POST_REPORT:79,TIMELINE_BREAKUP:80,POLITICIANS_FEED:81,PRODUCT_DETAILS:82,SPORTS_PLAY_FEED:83,GROUP_TOP_STORIES:84,PAGE_TIMELINE_PERMALINK:86,OFFERS_WALLET:87,INSTREAM_VIDEO_IN_LIVE:88,SPOTLIGHT:89,SEARCH_DERP:90,SOCIAL_BALLOT:91,GROUP_SUGGESTIONS_WITH_STORY:92,SOCIAL_BALLOT_PERMALINK:93,LOCAL_SERP:94,FUNDRAISER_SELF_DONATION_FEED:95,CONVERSATION_NUB:97,GROUP_TOP_SALE_STORIES:98,GROUP_LEARNING_COURSE_UNIT_FEED:99,SUPPORT_INBOX_READ_TIME_BLOCK:100,PAGE_POSTS_CARD:101,CRISIS_POST:102,SUPPORT_INBOX_GROUP_RESPONSIBLE:103,PAGE_POST_DIALOG:104,CRISIS_DIALOG_POST:105,PAGE_LIVE_VIDEOS_CARD:106,PAGE_POSTS_CARD_COMPACT:107,GROUP_MEMBER_BIO_FEED:108,LIVE_COMMENT_ATTACHMENT:109,GROUP_COMPOSER:110,GROUP_INBOX_GROUP:111,GROUP_INBOX_AGGREGATED:112,ENDORSEMENTS:113,EVENTS_DASHBOARD:114,CURATED_COLLECTIONS_PAGE:115,OYML:116,COLLEGE_HOMEPAGE:117,GROUP_LIVE_VIDEOS_CARD:118,COLLEGE_HIGHLIGHTS:119,VIDEO_PERMALINK:120,JOB_CAROUSEL_NETEGO:121,TOPIC_PAGE:122,USER_SCHEDULED_POSTS:123,GOODWILL_THROWBACK_ATTACHMENT_PREVIEW:124,INSTREAM_VIDEO_IN_WASLIVE:125,INSTREAM_VIDEO_IN_NONLIVE:126,SIGNAL_APP:127,ALBUM_FEED:128,TOP_MARKETPLACE_STORIES:129,CE_PII_STRIPPED_FEED:130,TAHOE:131,SAVE_COUNT_DIALOG:132,GROUP_POST_TAG_FEED:133,GOV_DIGEST:134};}),null);
__d("TranslationTrigger",[],(function a(b,c,d,e,f,g){f.exports={SEE_TRANSLATION:"see_translation",AUTO_TRANSLATION:"auto_translation",SEE_CONVERSION:"see_conversion",TRANSLATE_ALL:"translate_all",LOGGED_OUT_AUTO_TRANSLATION:"logged_out_auto_translation",NONE:"none"};}),null);
__d("UFIStoryActionType",[],(function a(b,c,d,e,f,g){f.exports={CHANGE_ACCEPTED_ANSWER:"story_change_accepted_answer",COMMENTS_ARRIVED:"story_comments_arrived",PAGE_IN_COMMENTS:"story_page_in_comments",SHOW_REPLIES:"story_show_replies",SHOW_COMMENTS:"story_show_comments",SPAM_FETCHED:"story_spam_fetched",CHANGE_REACTION:"story_change_reaction",CHANGE_REACTION_FAILURE:"story_change_reaction_failure",CHANGE_REACTION_SUCCESS:"story_change_reaction_success",TOGGLE_REPLIES:"story_toggle_replies",FRIEND_TYPING:"story_friend_typing",SOMEONE_TYPING:"story_someone_typing",TYPING_STOPPED:"story_typing_stopped",LIVE_PIN_COMMENT:"story_live_pin_comment",LIVE_UNPIN_COMMENT:"story_live_unpin_comment"};}),null);
__d("UFIStreamingStateType",[],(function a(b,c,d,e,f,g){f.exports={LIVE:"live",ON_DEMAND:"on_demand"};}),null);
__d('UFICommentTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],(function a(b,c,d,e,f,g){'use strict';function h(){this.clear();}h.prototype.log=function(){c('GeneratedLoggerUtils').log('logger:UFICommentLoggerConfig',this.$UFICommentTypedLogger1,c('Banzai').BASIC);};h.prototype.logVital=function(){c('GeneratedLoggerUtils').log('logger:UFICommentLoggerConfig',this.$UFICommentTypedLogger1,c('Banzai').VITAL);};h.prototype.clear=function(){this.$UFICommentTypedLogger1={};return this;};h.prototype.updateData=function(j){this.$UFICommentTypedLogger1=babelHelpers['extends']({},this.$UFICommentTypedLogger1,j);return this;};h.prototype.setDuration=function(j){this.$UFICommentTypedLogger1.duration=j;return this;};h.prototype.setEvent=function(j){this.$UFICommentTypedLogger1.event=j;return this;};h.prototype.setHasPhoto=function(j){this.$UFICommentTypedLogger1.has_photo=j;return this;};h.prototype.setHasSticker=function(j){this.$UFICommentTypedLogger1.has_sticker=j;return this;};h.prototype.setIsReply=function(j){this.$UFICommentTypedLogger1.is_reply=j;return this;};h.prototype.setRequestLength=function(j){this.$UFICommentTypedLogger1.request_length=j;return this;};h.prototype.setVC=function(j){this.$UFICommentTypedLogger1.vc=j;return this;};var i={duration:true,event:true,has_photo:true,has_sticker:true,is_reply:true,request_length:true,vc:true};f.exports=h;}),null);
__d('UFICommentLogger',['UFICommentTypedLogger'],(function a(b,c,d,e,f,g){'use strict';function h(){this.$UFICommentLogger1={};this.$UFICommentLogger2={};}h.prototype.logNewCommentPost=function(i,j,k){this.$UFICommentLogger2[i]=babelHelpers['extends']({timestamp:j},k);new (c('UFICommentTypedLogger'))().setEvent('new_comment_post').setHasPhoto(k.has_photo).setHasSticker(k.has_sticker).setIsReply(k.is_reply).log();};h.prototype.logNewCommentReceived=function(i,j){var k=this.$UFICommentLogger2[i];if(k){var l=0;if(j&&k.timestamp)l=j-k.timestamp;new (c('UFICommentTypedLogger'))().setEvent('new_comment_received').setDuration(l).setHasPhoto(k.has_photo).setHasSticker(k.has_sticker).setIsReply(k.is_reply).log();}delete this.$UFICommentLogger2[i];};h.prototype.logCommentFetch=function(i,j,k){var l=babelHelpers['extends']({timestamp:j},k);if(this.$UFICommentLogger1[i]===undefined){this.$UFICommentLogger1[i]=[l];}else this.$UFICommentLogger1[i].push(l);new (c('UFICommentTypedLogger'))().setEvent('fetch_comment').setIsReply(k.is_reply).setRequestLength(k.request_length).log();};h.prototype.logCommentFetchReceived=function(i,j){if(this.$UFICommentLogger1[i]){var k=this.$UFICommentLogger1[i].shift(),l=0;if(j&&k.timestamp)l=j-k.timestamp;new (c('UFICommentTypedLogger'))().setEvent('fetch_comment_received').setDuration(l).setIsReply(k.is_reply).setRequestLength(k.request_length).log();if(this.$UFICommentLogger1[i].length===0)delete this.$UFICommentLogger1[i];}};f.exports=new h();}),null);
__d('UFIAcceptedAnswerStore',['FluxReduceStore','UFIDispatcherBase','UFIStoryActionType'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('FluxReduceStore'));i=h&&h.prototype;j.prototype.getInitialState=function(){return {};};j.prototype.reduce=function(k,l){var m;switch(l.type){case c('UFIStoryActionType').CHANGE_ACCEPTED_ANSWER:return babelHelpers['extends']({},k,(m={},m[l.comment.ftentidentifier]=l.doAccept?{type:'Accepted',id:l.comment.id}:{type:'NoneAccepted'},m));default:return k;}};j.prototype.get=function(k,l){var m=this.getState()[k];if(m)return m;return l?{type:'Accepted',id:l}:{type:'NoneAccepted'};};function j(){h.apply(this,arguments);}f.exports=new j(c('UFIDispatcherBase'));}),null);
__d('UFICommentEditIDStore',['FluxReduceStore','UFIAddCommentActionType','UFICentralUpdates','UFICommentActionType','UFIDispatcherBase'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('FluxReduceStore'));i=h&&h.prototype;function j(k){i.constructor.call(this,k);c('UFICentralUpdates').subscribe('actor-changed',function(l,m){c('UFIDispatcherBase').dispatch({type:'PRIVATE_ACTOR_CHANGED',instanceID:true,ftentidentifier:true});});}j.prototype.getInitialState=function(){return {};};j.prototype.getForInstance=function(k){return this.getState()[k]||null;};j.prototype.reduce=function(k,l){var m;switch(l.type){case 'PRIVATE_ACTOR_CHANGED':return {};case c('UFIAddCommentActionType').CANCEL:case c('UFIAddCommentActionType').SUBMIT_EDIT:var n=k[l.instanceID],o=babelHelpers.objectWithoutProperties(k,[l.instanceID]);return o;case c('UFICommentActionType').EDIT:return babelHelpers['extends']({},k,(m={},m[l.instanceID]=l.comment.id,m));}return k;};f.exports=new j(c('UFIDispatcherBase'));}),null);
__d('UFIComments',['invariant','ClientIDs','ImmutableObject','LiveWWWFeedbackTypedLogger','UFICentralUpdates','UFIConstants','randomInt'],(function a(b,c,d,e,f,g,h){'use strict';var i={},j={},k={};function l(ea){return ea in j?j[ea]:ea;}function m(ea,fa){ea.forEach(function(ga){var ha=ga.ftentidentifier,ia=c('UFIConstants').UFIPayloadSourceType,ja=ga.clientid,ka=false,la=babelHelpers['extends']({},ga);if(ja){delete la.clientid;ka=c('ClientIDs').isExistingClientID(ja);if(ka&&j[ja]){new (c('LiveWWWFeedbackTypedLogger'))().setEvent('update_view').setUpdateType('comment').setOriginatedLocally(true).setCommentID(ga.id).log();return;}}if(fa===ia.LIVE_SEND||fa===c('UFIConstants').UFIPayloadSourceType.STREAMING||fa===ia.USER_ACTION||fa===ia.ENDPOINT_ADD_COMMENT||fa===ia.ENDPOINT_EDIT_COMMENT)la.isunseen=true;if(fa===c('UFIConstants').UFIPayloadSourceType.LIVE_SEND||fa===c('UFIConstants').UFIPayloadSourceType.STREAMING)la.islive=true;if(fa===ia.ENDPOINT_COMMENT_FETCH||fa===ia.ENDPOINT_ID_COMMENT_FETCH)la.fromfetch=true;if(ka&&i[ja]){la.ufiinstanceid=i[ja].ufiinstanceid;j[ja]=ga.id;k[ga.id]=ja;i[ga.id]=i[ja];delete i[ja];c('UFICentralUpdates').didUpdateComment(ja);}da.setComment(ga.id,new (c('ImmutableObject'))(la));c('UFICentralUpdates').didUpdateComment(ga.id);c('UFICentralUpdates').didUpdateFeedback(ha);});}function n(ea,fa){for(var ga=0;ga<ea.length;ga++){var ha=ea[ga];switch(ha.actiontype){case c('UFIConstants').UFIActionType.LIKE_ACTION:if(da.getComment(ha.entidentifier))o(ha.clientid,ha.entidentifier,ha.hasviewerliked,ha.likecount,ha.reactiondata,fa);break;case c('UFIConstants').UFIActionType.COMMENT_LIKE:o(ha.clientid,ha.commentid,ha.viewerliked,ha.likecount,ha.reactiondata,fa);break;case c('UFIConstants').UFIActionType.REACTION:if(da.getComment(ha.entidentifier))p(ha.entidentifier,ha);break;case c('UFIConstants').UFIActionType.COMMENT_REACTION:p(ha.commentid,ha);break;case c('UFIConstants').UFIActionType.DELETE_COMMENT:t(ha);break;case c('UFIConstants').UFIActionType.LIVE_DELETE_COMMENT:u(ha);break;case c('UFIConstants').UFIActionType.CHANGE_ACCEPTED_ANSWER:v(ha);break;case c('UFIConstants').UFIActionType.REMOVE_PREVIEW:w(ha);break;case c('UFIConstants').UFIActionType.COMMENT_SET_SPAM:x(ha);break;case c('UFIConstants').UFIActionType.COMMENT_KEEP_SPAM:y(ha);break;case c('UFIConstants').UFIActionType.CONFIRM_COMMENT_REMOVAL:z(ha);break;case c('UFIConstants').UFIActionType.TRANSLATE_COMMENT:r(ha);break;case c('UFIConstants').UFIActionType.COMMENT_LIKECOUNT_UPDATE:q(ha);break;case c('UFIConstants').UFIActionType.UPDATE_CONSTITUENT_TITLE:ba(ha);break;}}}function o(ea,fa,ga,ha,ia,ja){var ka=da.getComment(fa);if(ka){var la={},ma=ea&&c('ClientIDs').isExistingClientID(ea);if(!ma){la.hasviewerliked=ga;la.likecount=ha;if(ia){la.reactioncount=ia.reactioncount;la.reactioncountmap=ia.reactioncountmap;la.reactioncountreduced=ia.reactioncountreduced;la.viewerreaction=ia.viewerreaction;}}if(ja===c('UFIConstants').UFIPayloadSourceType.LIVE_SEND||ja===c('UFIConstants').UFIPayloadSourceType.STREAMING)new (c('LiveWWWFeedbackTypedLogger'))().setEvent('update_view').setUpdateType('comment_like').setOriginatedLocally(ma).setCommentID(fa).log();la.likeconfirmhash=c('randomInt')(0,1024);ca(fa,la);}}function p(ea,fa){var ga=da.getComment(ea);if(ga){var ha={};if(fa.clientid&&c('ClientIDs').isExistingClientID(fa.clientid)&&fa.viewerreaction!==ga.viewerreaction)return;ha.hasviewerliked=fa.hasviewerliked;ha.likecount=fa.likecount;ha.reactioncount=fa.reactioncount;ha.reactioncountmap=fa.reactioncountmap;ha.reactioncountreduced=fa.reactioncountreduced;ha.viewerreaction=fa.viewerreaction;ca(ea,ha);}}function q(ea){var fa=da.getComment(ea.commentid);if(fa&&ea.hasviewerliked===fa.hasviewerliked){var ga={likecount:ea.likecount,likeconfirmhash:c('randomInt')(0,1024)};ca(ea.commentid,ga);}}function r(ea){var fa=ea.commentid,ga=da.getComment(fa);if(ga){var ha={translationdata:ea.translationdata};ca(fa,ha);}}function s(ea){var fa={reportLink:ea.reportLink,commenterIsFOF:ea.commenterIsFOF,userIsMinor:ea.userIsMinor,giveFeedbackLink:ea.giveFeedbackLink,reportGroupAdminLink:ea.reportGroupAdminLink};return fa;}function t(ea){var fa=da.getComment(ea.commentid);aa(fa,c('UFIConstants').UFIStatus.DELETED);}function u(ea){var fa=da.getComment(ea.commentid);if(fa&&fa.status!==c('UFIConstants').UFIStatus.DELETED)aa(fa,c('UFIConstants').UFIStatus.LIVE_DELETED);}function v(ea){ca(ea.commentid,{postacceptedanswer:ea.isaccepted?ea.commentid:null});}function w(ea){ca(ea.commentid,{attachment:null});}function x(ea){var fa=da.getComment(ea.commentid),ga=ea.shouldHideAsSpam?c('UFIConstants').UFIStatus.SPAM_DISPLAY:null;aa(fa,ga);}function y(ea){var fa=da.getComment(ea.commentid);ca(fa.id,{needsApproval:false,isApproved:true});}function z(ea){ca(ea.commentid,s(ea));}function aa(ea,fa){ca(ea.id,{priorstatus:ea.status,status:fa});}function ba(ea){var fa=da.getComment(ea.commentid);if(fa){var ga={constituentTitle:ea.constituentTitle};ca(ea.commentid,ga);}}function ca(ea,fa){var ga=da.getComment(ea)||new (c('ImmutableObject'))({});da.setComment(ea,c('ImmutableObject').set(ga,fa));c('UFICentralUpdates').didUpdateComment(ga.id);c('UFICentralUpdates').didUpdateFeedback(ga.ftentidentifier);}var da={getRenderKey:function ea(fa){return 'comment'+(fa in k?k[fa]:fa);},getComment:function ea(fa){if(fa===c('UFIConstants').unavailableCommentKey)return null;return i[l(fa)];},setComment:function ea(fa,ga){ga instanceof c('ImmutableObject')||h(0);i[l(fa)]=ga;},resetComments:function ea(fa){for(var ga in fa)delete i[l(ga)];},getCommentsForFTEntIdentifier:function ea(fa){return Object.values(i).filter(function(ga){return ga.ftentidentifier==fa;});}};c('UFICentralUpdates').subscribe('update-comments',function(ea,fa){if(fa.comments&&fa.comments.length)m(fa.comments,fa.payloadsource);if(fa.pinnedcomments&&fa.pinnedcomments.length)m(fa.pinnedcomments,fa.payloadsource);});c('UFICentralUpdates').subscribe('update-actions',function(ea,fa){if(fa.actions&&fa.actions.length)n(fa.actions,fa.payloadsource);});f.exports=da;}),22);
__d('UFILivePinnedCommentStore',['FluxReduceStore','UFIComments','UFIFeedbackTargets','UFIDispatcherBase','UFIStoryActionType','areEqual'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('FluxReduceStore'));i=h&&h.prototype;j.prototype.getInitialState=function(){return {};};j.prototype.reduce=function(k,l){var m;switch(l.type){case c('UFIStoryActionType').LIVE_PIN_COMMENT:case c('UFIStoryActionType').LIVE_UNPIN_COMMENT:var n=l.commentID,o=l.pinEventID;return babelHelpers['extends']({},k,(m={},m[l.ftentidentifier]={commentID:n,pinEventID:o},m));default:return k;}};j.prototype.areEqual=function(k,l){return c('areEqual')(k,l);};j.prototype.getPinnedCommentID=function(k){var l=this.getState()[k];if(!l){var m=c('UFIFeedbackTargets').getFeedbackTargetIfExists(k);if(!m)return null;return m.livepinnedcommentid||null;}return l.commentID||null;};j.prototype.getPinEventID=function(k){var l=this.getState()[k];if(!l)return null;return l.pinEventID||null;};j.prototype.getPinnedCommentAuthorID=function(k){var l=this.getPinnedCommentID(k);if(l===null)return null;return c('UFIComments').getComment(l).author||null;};function j(){h.apply(this,arguments);}f.exports=new j(c('UFIDispatcherBase'));}),null);
__d('UFIVisibility',[],(function a(b,c,d,e,f,g){'use strict';var h={VISIBLE:'visible',HIDDEN:'hidden'};f.exports=h;}),null);
__d('UFICommentVisibilityStore',['invariant','FluxReduceStore','UFICommentActionType','UFIComments','UFIDispatcherBase','UFIInstanceActionType','UFILivePinnedCommentStore','UFIRootRegistry','UFIVisibility','filterObject'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;function k(p){var q=arguments.length<=1||arguments[1]===undefined?null:arguments[1],r=arguments.length<=2||arguments[2]===undefined?null:arguments[2];q===null&&r===null||q!==null&&r!==null||h(0);if(q)return p+'-'+q+(r?'-P':'');return p;}function l(p,q){return p===q||p.startsWith(q+'-');}function m(p){var q=c('UFIRootRegistry').getInstanceIDFromFTEntIdentifier(p);return q?q:[];}function n(p){return {instanceid:p};}i=babelHelpers.inherits(o,c('FluxReduceStore'));j=i&&i.prototype;o.prototype.getInitialState=function(){return {};};o.prototype.getVisibility=function(p,q){var r=arguments.length<=2||arguments[2]===undefined?null:arguments[2],s=r?k(q.instanceid,r.comment.fbid,r.isLivePinnedComment):k(q.instanceid);if(Object.prototype.hasOwnProperty.call(p,s))return p[s];return c('UFIVisibility').HIDDEN;};o.prototype.$UFICommentVisibilityStore1=function(p){var q=n(p);return this.getVisibility(this.getState(),q)===c('UFIVisibility').VISIBLE;};o.prototype.isFeedbackTargetVisible=function(p){var q=m(p);return q.some(function(r){return this.$UFICommentVisibilityStore1(r);}.bind(this));};o.prototype.reduce=function(p,q){var r,s;switch(q.type){case c('UFICommentActionType').UNMOUNTED:var t=babelHelpers['extends']({},p);delete t[k(q.instanceID,q.renderedComment.comment.fbid,q.renderedComment.isLivePinnedComment)];return t;case c('UFICommentActionType').CHANGE_VISIBILITY:return babelHelpers['extends']({},p,(r={},r[k(q.instanceID,q.renderedComment.comment.fbid,q.renderedComment.isLivePinnedComment)]=q.visibility,r));case c('UFIInstanceActionType').CHANGE_VISIBILITY:var u=c('UFIRootRegistry').getFTEntIdentifierFromInstanceID(q.instanceID),v=c('UFIComments').getCommentsForFTEntIdentifier(u);q.type===c('UFIInstanceActionType').CHANGE_VISIBILITY||h(0);var w=q.visibility,x=v.reduce(function(ca,da){ca[k(q.instanceID,da.fbid,da.fbid?false:null)]=w;return ca;},{});if(u){var y=c('UFILivePinnedCommentStore').getPinnedCommentID(u);if(y!==null){var z=c('UFIComments').getComment(y);x[k(q.instanceID,z.fbid,true)]=w;}}return babelHelpers['extends']({},p,(s={},s[k(q.instanceID)]=q.visibility,s),x);case c('UFIInstanceActionType').REMOVE:var aa=q.instanceID,ba=k(aa);return c('filterObject')(p,function(ca,da){return da!==ba&&!l(da,aa);});}return p;};function o(){i.apply(this,arguments);}f.exports=new o(c('UFIDispatcherBase'));}),null);
__d('UFIKeyValueStore',['FluxReduceStore','abstractMethod'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('FluxReduceStore'));i=h&&h.prototype;j.prototype.getInitialState=function(){return {};};j.prototype.getValueFor=function(k){return this.getState()[k]||null;};j.prototype.getStateKey=function(k){return k.instanceID;};j.prototype.getStateValue=function(k){return c('abstractMethod')('UFIKeyValueStore','getStateValue');};j.prototype.reduce=function(k,l){var m=this.getStateKey(l),n=this.getStateValue(l);if(n!==null){var o;return babelHelpers['extends']({},k,(o={},o[m]=n,o));}return k;};function j(){h.apply(this,arguments);}f.exports=j;}),null);
__d('UFICommercialBreakStore',['UFIKeyValueStore','UFIInstanceActionType','UFIDispatcherBase'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('UFIKeyValueStore'));i=h&&h.prototype;j.prototype.getValueFor=function(k){return !!i.getValueFor.call(this,k);};j.prototype.getStateValue=function(k){switch(k.type){case c('UFIInstanceActionType').TOGGLE_COMMERCIAL_BREAK:return k.inCommercial;}return null;};function j(){h.apply(this,arguments);}f.exports=new j(c('UFIDispatcherBase'));}),null);
__d('UFIComposerIsTypingStore',['UFIKeyValueStore','UFIAddCommentActionType','UFIDispatcherBase'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('UFIKeyValueStore'));i=h&&h.prototype;j.prototype.getStateKey=function(k){return k.ftentidentifier;};j.prototype.getStateValue=function(k){switch(k.type){case c('UFIAddCommentActionType').SUBMIT_EDIT:return false;case c('UFIAddCommentActionType').SUBMIT_NEW:return false;case c('UFIAddCommentActionType').CHANGE_CONTENT:var l=k.text.trim().length;return l>0;}return null;};function j(){h.apply(this,arguments);}f.exports=new j(c('UFIDispatcherBase'));}),null);
__d('UFIInteractionStore',['UFIAddCommentActionType','UFICommentActionType','UFIDispatcherBase','UFIInstanceActionType','UFIKeyValueStore','UFIStoryActionType'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('UFIKeyValueStore'));i=h&&h.prototype;j.prototype.getValueFor=function(k){return !!i.getValueFor.call(this,k);};j.prototype.getStateValue=function(k){switch(k.type){case c('UFIAddCommentActionType').CHANGE_CONTENT:case c('UFIAddCommentActionType').SUBMIT_EDIT:case c('UFIAddCommentActionType').SUBMIT_NEW:case c('UFICommentActionType').CHANGE_REACTION:case c('UFICommentActionType').EDIT:case c('UFICommentActionType').REMOVE:case c('UFICommentActionType').TOGGLE_LIKE:case c('UFICommentActionType').TOGGLE_MARK_AS_SPAM:case c('UFICommentActionType').TRANSLATE:case c('UFIInstanceActionType').CHANGE_ORDER_MODE:case c('UFIInstanceActionType').TOGGLE_COMMENTS:case c('UFIStoryActionType').PAGE_IN_COMMENTS:case c('UFIStoryActionType').SHOW_REPLIES:case c('UFIStoryActionType').TOGGLE_REPLIES:return true;}return null;};function j(){h.apply(this,arguments);}f.exports=new j(c('UFIDispatcherBase'));}),null);
__d('UFILiveTypingStore',['FluxReduceStore','UFIDispatcherBase','UFIStoryActionType'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('FluxReduceStore'));i=h&&h.prototype;j.getNewFeedbackState=function(k){switch(k){case c('UFIStoryActionType').FRIEND_TYPING:return 'friend';case c('UFIStoryActionType').SOMEONE_TYPING:return 'someone';case c('UFIStoryActionType').TYPING_STOPPED:return false;default:return null;}};j.prototype.getInitialState=function(){return {};};j.prototype.reduce=function(k,l){var m=j.getNewFeedbackState(l.type);if(m!==null){var n;k=babelHelpers['extends']({},k,(n={},n[l.ftentidentifier]=m,n));}return k;};j.prototype.isFriendTyping=function(k){return this.getState()[k]==='friend';};function j(){h.apply(this,arguments);}f.exports=new j(c('UFIDispatcherBase'));}),null);
__d('UFIActionTypes',['UFIInstanceActionType','UFIStoryActionType','UFIAddCommentActionType','UFICommentActionType'],(function a(b,c,d,e,f,g){'use strict';var h={INSTANCE:c('UFIInstanceActionType'),STORY:c('UFIStoryActionType'),ADD_COMMENT:c('UFIAddCommentActionType'),COMMENT:c('UFICommentActionType')};f.exports=h;}),null);
__d('UFIReactionPendingRequestsStore',['FluxReduceStore','UFIActionTypes','UFIDispatcherBase'],(function a(b,c,d,e,f,g){'use strict';var h,i;function j(o){return o+'-comment';}function k(o){return o+'-story';}function l(o,p){var q;return babelHelpers['extends']({},o,(q={},q[p]=(o[p]||0)+1,q));}function m(o,p){var q;return babelHelpers['extends']({},o,(q={},q[p]=(o[p]||0)-1,q));}h=babelHelpers.inherits(n,c('FluxReduceStore'));i=h&&h.prototype;n.prototype.getInitialState=function(){return {};};n.prototype.reduce=function(o,p){switch(p.type){case c('UFIActionTypes').STORY.CHANGE_REACTION:return l(o,k(p.ftentidentifier));case c('UFIActionTypes').COMMENT.CHANGE_REACTION:return l(o,j(p.fbid));case c('UFIActionTypes').STORY.CHANGE_REACTION_SUCCESS:case c('UFIActionTypes').STORY.CHANGE_REACTION_FAILURE:return m(o,k(p.ftentidentifier));case c('UFIActionTypes').COMMENT.CHANGE_REACTION_FAILURE:case c('UFIActionTypes').COMMENT.CHANGE_REACTION_SUCCESS:return m(o,j(p.fbid));}return o;};n.prototype.getPendingRequestsForComment=function(o){return this.getState()[j(o)]||0;};n.prototype.getPendingRequests=function(o){return this.getState()[k(o)]||0;};function n(){h.apply(this,arguments);}f.exports=new n(c('UFIDispatcherBase'));}),null);
__d('UFIReactionSyncStore',['FluxReduceStore','UFIActionTypes','UFIDispatcherBase'],(function a(b,c,d,e,f,g){'use strict';var h,i;function j(m){return m+'-comment';}function k(m){return m+'-story';}h=babelHelpers.inherits(l,c('FluxReduceStore'));i=h&&h.prototype;l.prototype.getInitialState=function(){return {};};l.prototype.reduce=function(m,n){var o,p,q;switch(n.type){case c('UFIActionTypes').INSTANCE.INIT:var r=n.payload,s=r.feedbacktarget?r.feedbacktarget:r.feedbacktargets&&r.feedbacktargets[0];if(!s)return m;var t=n.payload.comments.reduce(function(u,v){u[j(v.fbid)]=v.viewerreaction;return u;},{});return babelHelpers['extends']({},m,t,(o={},o[k(n.ftentidentifier)]=s.viewerreaction,o));case c('UFIActionTypes').STORY.CHANGE_REACTION_SUCCESS:return babelHelpers['extends']({},m,(p={},p[k(n.ftentidentifier)]=n.reactionType,p));case c('UFIActionTypes').COMMENT.CHANGE_REACTION_SUCCESS:return babelHelpers['extends']({},m,(q={},q[j(n.fbid)]=n.reactionType,q));default:return m;}};l.prototype.getLastKnownCommentReaction=function(m){return this.getState()[j(m)];};l.prototype.getLastKnownReaction=function(m){return this.getState()[k(m)];};function l(){h.apply(this,arguments);}f.exports=new l(c('UFIDispatcherBase'));}),null);
__d('UFISharedDispatcher',['UFIDispatcherBase','UFIFeedbackStore','UFIAcceptedAnswerStore','UFICommentEditIDStore','UFICommentVisibilityStore','UFICommercialBreakStore','UFIComposerIsTypingStore','UFIInteractionStore','UFILivePinnedCommentStore','UFILiveTypingStore','UFILocallyComposedCommentStore','UFIOrderingModeStore','UFIReactionPendingRequestsStore','UFIReactionSyncStore','UFISpamStore'],(function a(b,c,d,e,f,g){'use strict';c('UFIFeedbackStore');c('UFIAcceptedAnswerStore');c('UFICommentEditIDStore');c('UFICommentVisibilityStore');c('UFICommercialBreakStore');c('UFIComposerIsTypingStore');c('UFIFeedbackStore');c('UFIInteractionStore');c('UFILivePinnedCommentStore');c('UFILiveTypingStore');c('UFILocallyComposedCommentStore');c('UFIOrderingModeStore');c('UFIReactionPendingRequestsStore');c('UFIReactionSyncStore');c('UFISpamStore');f.exports=c('UFIDispatcherBase');}),null);
__d('UFICommentAction',['UFICommentActionType'],(function a(b,c,d,e,f,g){'use strict';var h={changeReaction:function i(j,k,l,m){return {type:c('UFICommentActionType').CHANGE_REACTION,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k,reactionType:l,target:m};},changeReactionSuccess:function i(j,k,l){return {type:c('UFICommentActionType').CHANGE_REACTION_SUCCESS,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k,reactionType:l};},changeReactionFailure:function i(j,k,l){return {type:c('UFICommentActionType').CHANGE_REACTION_FAILURE,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k,reactionType:l};},mounted:function i(j,k){return {type:c('UFICommentActionType').MOUNTED,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.comment.fbid,renderedComment:k,contextArgs:j};},unmounted:function i(j,k){return {type:c('UFICommentActionType').UNMOUNTED,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.comment.fbid,renderedComment:k,contextArgs:j};},changeVisibility:function i(j,k,l){return {type:c('UFICommentActionType').CHANGE_VISIBILITY,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.comment.fbid,renderedComment:k,contextArgs:j,visibility:l};},edit:function i(j,k){return {type:c('UFICommentActionType').EDIT,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k};},remove:function i(j,k,l,m){return {type:c('UFICommentActionType').REMOVE,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k,target:l,onConfirm:m};},removePreview:function i(j,k,l){return {type:c('UFICommentActionType').REMOVE_PREVIEW,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k,target:l};},toggleLike:function i(j,k,l){return {type:c('UFICommentActionType').TOGGLE_LIKE,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k,like:!k.hasviewerliked,target:l};},translate:function i(j,k,l){return {type:c('UFICommentActionType').TRANSLATE,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k,trigger:l};},markAsSpam:function i(j,k,l){return {type:c('UFICommentActionType').TOGGLE_MARK_AS_SPAM,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k,is_spam:true,target:l};},markAsNotSpam:function i(j,k,l){return {type:c('UFICommentActionType').TOGGLE_MARK_AS_SPAM,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k,is_spam:false,target:l};},inlineBan:function i(j,k,l,m){return {type:c('UFICommentActionType').TOGGLE_INLINE_BAN,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k,is_banned:true,ownerid:m,target:l};},undoInlineBan:function i(j,k,l,m){return {type:c('UFICommentActionType').TOGGLE_INLINE_BAN,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k,is_banned:false,ownerid:m,target:l};},embed:function i(j,k){return {type:c('UFICommentActionType').EMBED,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k};},showConstituentTitle:function i(j,k){return {type:c('UFICommentActionType').SHOW_CONSTITUENT_TITLE,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k};},hideConstituentTitle:function i(j,k){return {type:c('UFICommentActionType').HIDE_CONSTITUENT_TITLE,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k};},keepSpam:function i(j,k,l){return {type:c('UFICommentActionType').TOGGLE_KEEP_SPAM,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,fbid:k.fbid,comment:k,target:l};}};f.exports=h;}),null);
__d('UFIReactionsUtils',[],(function a(b,c,d,e,f,g){var h={getReactionData:function i(j,k,l,m){k=parseInt(k,10);var n=!!k,o=j.reactorids?j.reactorids.slice(0):[],p=o.indexOf(l),q=0;if(n){if(p<0){o.unshift(l);q=1;}}else if(p>-1){o.splice(p,1);q=-1;}var r=Math.max(j.reactioncount+q,0),s=j.reactioncountreduced;if(s&&!isNaN(s))if(m){s=m(r);}else s=r.toString();var t=j.reactioncountmap||{},u,v=j.viewerreaction;if(v&&t[v]){t[v]['default']=Math.max((t[v]['default']||0)-1,0);u=t[v].reduced;if(u&&!isNaN(u))t[v].reduced=t[v]['default'].toString();}if(n&&t[k]){t[k]['default']=(t[k]['default']||0)+1;u=t[k].reduced;if(u&&!isNaN(u))t[k].reduced=t[k]['default'].toString();}var w=j.userreactions;if(!w||Array.isArray(w))w={};if(n){w[l]=k;}else delete w[l];var x=null;if(j.reactionsentences){var y=!(v&&k);x={current:j.reactionsentences[y?'alternate':'current'],alternate:j.reactionsentences[y?'current':'alternate']};}return {reactioncount:r,reactioncountmap:t,reactioncountreduced:s,reactionsentences:x,reactorids:o,userreactions:w,viewerreaction:k};},getReactionCountMapFromSummary:function i(j){var k={};if(!j)return k;for(var l=0;l<j.length;l++){var m=j[l],n=m.feedback_reaction.key;k[n]={'default':m.reactors&&m.reactors.count,reduced:m.reactors&&m.reactors.display_count};}return k;}};f.exports=h;}),null);
__d('UFIStoryAction',['UFIStoryActionType'],(function a(b,c,d,e,f,g){'use strict';var h={changeAcceptedAnswer:function i(j,k,l){return {type:c('UFIStoryActionType').CHANGE_ACCEPTED_ANSWER,instanceID:j.instanceid,ftentidentifier:k.ftentidentifier,comment:k,doAccept:l};},commentsArrived:function i(j,k,l,m){return {type:c('UFIStoryActionType').COMMENTS_ARRIVED,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,newOffset:k,newLength:l,source:m};},pageInComments:function i(j,k,l,m){return {type:c('UFIStoryActionType').PAGE_IN_COMMENTS,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,commentID:k,direction:l,nextRange:m};},showComments:function i(j){return {type:c('UFIStoryActionType').SHOW_COMMENTS,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier};},showReplies:function i(j,k,l){return {type:c('UFIStoryActionType').SHOW_REPLIES,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,commentID:k,initiatorComment:l};},spamFetched:function i(j,k,l,m){return {type:c('UFIStoryActionType').SPAM_FETCHED,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,viewas:k,commentIDs:l,parentCommentID:m};},changeReaction:function i(j,k,l){var m=arguments.length<=3||arguments[3]===undefined?null:arguments[3],n=arguments.length<=4||arguments[4]===undefined?null:arguments[4];return {type:c('UFIStoryActionType').CHANGE_REACTION,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,contextArgs:j,reactionType:k,target:l,sphericalYaw:m,sphericalPitch:n};},changeReactionSuccess:function i(j,k){return {type:c('UFIStoryActionType').CHANGE_REACTION_SUCCESS,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,reactionType:k};},changeReactionFailure:function i(j,k){return {type:c('UFIStoryActionType').CHANGE_REACTION_FAILURE,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,reactionType:k};},toggleReplies:function i(j,k){return {type:c('UFIStoryActionType').TOGGLE_REPLIES,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,commentID:k};},friendTyping:function i(j){return {type:c('UFIStoryActionType').FRIEND_TYPING,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier};},someoneTyping:function i(j){return {type:c('UFIStoryActionType').SOMEONE_TYPING,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier};},typingStopped:function i(j){return {type:c('UFIStoryActionType').TYPING_STOPPED,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier};},pinComment:function i(j,k){var l=arguments.length<=2||arguments[2]===undefined?null:arguments[2];return {type:c('UFIStoryActionType').LIVE_PIN_COMMENT,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,commentID:k,pinEventID:l};},unpinComment:function i(j){var k=arguments.length<=1||arguments[1]===undefined?null:arguments[1];return {type:c('UFIStoryActionType').LIVE_UNPIN_COMMENT,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,commentID:null,pinEventID:k};}};f.exports=h;}),null);
__d('UFIUserActionUtils',['Nectar','collectDataAttributes'],(function a(b,c,d,e,f,g){var h={trackingData:function i(j){if(!j)return {ft:{}};var k={ft:c('collectDataAttributes')(j,['ft']).ft};c('Nectar').addModuleData(k,j);return k;}};f.exports=h;}),null);
__d("XUFICommentReactionController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ufi\/comment\/reaction\/",{reaction_type:{type:"Enum",enumType:0}});}),null);
__d("XUFIReactionController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ufi\/reaction\/",{client_id:{type:"String"},ft_ent_identifier:{type:"String"},reaction_type:{type:"Enum",enumType:0},story_render_location:{type:"Enum",enumType:1},feedback_source:{type:"Int"},feedback_referrer:{type:"String"},basic_origin_uri:{type:"String"},basic_reload:{type:"Exists",defaultValue:false},on_demand_content_time_offset:{type:"Int"},live_content_time_offset:{type:"Int"},aftercursor:{type:"String"},tab:{type:"String"},av:{type:"Int"},_ft_:{type:"String"}});}),null);
__d('UFIReactionUserActions',['ActorURI','AsyncResponse','AsyncRequest','ClientIDs','ChannelClientID','NumberFormat','QE2Logger','MercuryServerDispatcher','UFICentralUpdates','UFICommentAction','UFIComments','UFIConfig','UFIConstants','UFIFeedbackTargets','UFIReactionPendingRequestsStore','UFIReactionSyncStore','UFIReactionTypes','UFISharedDispatcher','UFIStoryAction','UFIReactionsUtils','UFIUserActionUtils','UFIVideoPlayerRegistry','XUFIReactionController','XUFICommentReactionController','emptyFunction','ifRequired','setImmediate'],(function a(b,c,d,e,f,g){'use strict';var h={changeReaction:function z(aa,ba,ca,da){var ea=arguments.length<=4||arguments[4]===undefined?null:arguments[4],fa=arguments.length<=5||arguments[5]===undefined?null:arguments[5];c('UFIFeedbackTargets').getFeedbackTarget(aa,function(ga){var ha,ia=w(ga,ba);c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{actions:ia});var ja=c('UFIUserActionUtils').trackingData(da),ka={};ka[c('ActorURI').PARAMETER_ACTOR]=ga.actorforpost;var la=babelHelpers['extends']({client_id:c('ClientIDs').getNewClientID(),ft_ent_identifier:aa,reaction_type:ba,root_id:ca.rootid,session_id:c('ChannelClientID').getID(),source:ca.source,feedback_referrer:ca.feedbackReferrer,instance_id:ca.instanceid},ka,ja);if(ca.fluentContentToken)(function(){var ma=ca.fluentContentToken,na=c('UFIVideoPlayerRegistry').getAvailableVideoPlayerControllerForElement(da,ma);if(na&&na.isSpherical())la.video_playback_timestamp=c('UFIVideoPlayerRegistry').getAvailableVideoPlayerControllerTimeForElement(da,ma);if(ca.isLiveVOD){la.on_demand_content_time_offset=c('UFIVideoPlayerRegistry').getAvailableVideoPlayerControllerTimeForElement(da,ma);}else if(ca.islivestreaming)la.live_content_time_offset=c('UFIVideoPlayerRegistry').getAvailableVideoPlayerControllerTimeForElement(da,ma);if(na&&na.isSpherical())c('ifRequired')('SphericalViewportControlStore',function(oa){var pa=oa.getOrientation(na.getVideoPlayerID());if(pa)if(ea!==null&&fa!==null){la.spherical_yaw=ea;la.spherical_pitch=fa;}else{la.spherical_pitch=Math.round(pa.pitch);la.spherical_yaw=Math.round(pa.yaw);}},c('emptyFunction')());})();c('MercuryServerDispatcher').trySend(c('XUFIReactionController').getURIBuilder().getURI(),la);});},changeCommentReaction:function z(aa,ba,ca,da){var ea=c('UFIComments').getComment(aa);if(ea.viewerreaction!=ba)c('UFIFeedbackTargets').getFeedbackTarget(ea.ftentidentifier,function(fa){var ga=c('UFIUserActionUtils').trackingData(da),ha=v(ea,fa,ba);c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{actions:ha});var ia={};ia[c('ActorURI').PARAMETER_ACTOR]=fa.actorforpost;c('MercuryServerDispatcher').trySend(c('XUFICommentReactionController').getURIBuilder().getURI(),babelHelpers['extends']({comment_id:aa,legacy_id:ea.legacyid,reaction_type:ba,ft_ent_identifier:ea.ftentidentifier,source:ca.source,instance_id:ca.instanceid,client_id:c('ClientIDs').getNewClientID(),session_id:c('ChannelClientID').getID()},ga,ia));});}},i={},j=c('XUFIReactionController').getURIBuilder().getURI();i[j]={mode:c('MercuryServerDispatcher').IMMEDIATE,error_handler:r,handler:q};var k=c('XUFICommentReactionController').getURIBuilder().getURI();i[k]={mode:c('MercuryServerDispatcher').BATCH_CONDITIONAL,batch_if:l,batch_function:m,error_handler:u,handler:t};c('MercuryServerDispatcher').registerEndpoints(i);function l(z,aa){return z&&z.ft_ent_identifier==aa.ft_ent_identifier&&z.comment_id==aa.comment_id;}function m(z,aa){return aa;}var n='feedback_reactions_www_rollback_universe';function o(){c('QE2Logger').logExposureForUser(n);}function p(z,aa){var ba=c('UFIReactionPendingRequestsStore').getPendingRequests(z);if(ba>0)return;var ca=c('UFIReactionSyncStore').getLastKnownReaction(z);if(aa===ca)return;c('UFIFeedbackTargets').getFeedbackTarget(z,function(da){var ea=w(da,ca);c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{actions:ea});});}function q(z,aa){var ba=aa.data,ca=ba.ft_ent_identifier,da=ba.reaction_type;c('UFISharedDispatcher').dispatch(c('UFIStoryAction').changeReactionSuccess({instanceid:ba.instance_id,ftentidentifier:ca},da));c('setImmediate')(function(){return p(ca,da);});}function r(z){var aa=z.request.data,ba=aa.ft_ent_identifier,ca=aa.reaction_type;o();var da=c('UFIConfig').reactionsHasReactionsRollback,ea=c('UFIConfig').reactionsHasReactionsRetry;if(ea&&!aa.retry_attempt){c('MercuryServerDispatcher').trySend(c('XUFIReactionController').getURIBuilder().getURI(),babelHelpers['extends']({},aa,{retry_attempt:1}));return;}c('UFISharedDispatcher').dispatch(c('UFIStoryAction').changeReactionFailure({instanceid:aa.instance_id,ftentidentifier:ba},ca));if(da)c('setImmediate')(function(){return p(ba,ca);});c('AsyncResponse').defaultErrorHandler(z);}function s(z,aa,ba){var ca=c('UFIReactionPendingRequestsStore').getPendingRequestsForComment(aa.fbid);if(ca>0)return;var da=c('UFIReactionSyncStore').getLastKnownCommentReaction(aa.fbid);if(ba===da)return;c('UFIFeedbackTargets').getFeedbackTarget(z,function(ea){var fa=v(aa,ea,da);c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{actions:fa});});}function t(z,aa){var ba=aa.data,ca=ba.ft_ent_identifier,da=ba.reaction_type,ea=c('UFIComments').getComment(ba.comment_id);if(!ea)return;c('UFISharedDispatcher').dispatch(c('UFICommentAction').changeReactionSuccess({instanceid:ba.instance_id,ftentidentifier:ca},ea,da));c('setImmediate')(function(){return s(ca,ea,da);});}function u(z){var aa=z.request.data,ba=aa.ft_ent_identifier,ca=aa.reaction_type,da=c('UFIComments').getComment(aa.comment_id);if(!da)return;o();var ea=c('UFIConfig').reactionsHasCommentReactionsRollback,fa=c('UFIConfig').reactionsHasCommentReactionsRetry;if(fa&&!aa.retry_attempt){c('MercuryServerDispatcher').trySend(c('XUFICommentReactionController').getURIBuilder().getURI(),babelHelpers['extends']({},aa,{retry_attempt:1}));return;}c('UFISharedDispatcher').dispatch(c('UFICommentAction').changeReactionFailure({instanceid:aa.instance_id,ftentidentifier:ba},da,ca));if(ea)c('setImmediate')(function(){return s(ba,da,ca);});c('AsyncResponse').defaultErrorHandler(z);}function v(z,aa,ba){var ca=z.id,da=[y(z,ba,ca,aa.supportedreactions||[],aa.actorforpost)],ea=ba===c('UFIReactionTypes').LIKE;if(aa.hasviewerliked!==ea){var fa=ea?1:-1;da.push({commentid:ca,actiontype:c('UFIConstants').UFIActionType.COMMENT_LIKE,viewerliked:ea,likecount:(z.likecount||0)+fa});}return da;}function w(z,aa){var ba=[x(z,aa)],ca=aa!==c('UFIReactionTypes').NONE;if(z.hasviewerliked!==ca){var da=ca?1:-1;ba.push({actiontype:c('UFIConstants').UFIActionType.LIKE_ACTION,actorid:z.actorforpost,hasviewerliked:ca,likecount:(z.likecount||0)+da,entidentifier:z.entidentifier,likesentences:{current:z.likesentences.alternate,alternate:z.likesentences.current}});}return ba;}function x(z,aa){return Object.assign({actiontype:c('UFIConstants').UFIActionType.REACTION,actorid:z.actorforpost,entidentifier:z.entidentifier},c('UFIReactionsUtils').getReactionData(z,aa,z.actorforpost,c('NumberFormat').formatInteger));}function y(z,aa,ba,ca,da){var ea={};for(var fa=0;fa<ca.length;fa++){var ga=ca[fa],ha=z.reactioncountmap?z.reactioncountmap[ga]:null;ea[ga]={'default':ha?ha['default']:0,reduced:ha?ha.reduced:'0'};}var ia=c('UFIReactionsUtils').getReactionData({viewerreaction:z.viewerreaction,reactioncount:z.reactioncount,reactioncountreduced:z.reactioncountreduced,reactioncountmap:ea,reactorids:z.viewerreaction?[da]:[]},aa,da);return {actiontype:c('UFIConstants').UFIActionType.COMMENT_REACTION,commentid:ba,hasviewerliked:!!aa,likecount:ia.reactioncountmap[1]['default'],reactioncount:ia.reactioncount,reactioncountmap:ia.reactioncountmap,reactioncountreduced:ia.reactioncountreduced,viewerreaction:aa};}f.exports=h;}),null);
__d('UFIPagedCommentListImpl',['ClientIDs','KeyedCallbackManager','UFICentralUpdates','UFICommentLogger','UFIConfig','UFIConstants','UFIFeedbackTargets'],(function a(b,c,d,e,f,g){'use strict';function h(i){this.actorID=null;this.basePermalink=null;this.commentPermalinks=Object.create(null);this.count=0;this.dataSource=new (c('KeyedCallbackManager'))();this.deletedComments=Object.create(null);this.deletedCount=0;this.lastRequestedLength=0;this.lastRequestedOffset=0;this.feedbackTargetID=i;c('UFIFeedbackTargets').getFeedbackTarget(this.feedbackTargetID,function(j){this.actorID=j.actorforpost;this.basePermalink=j.permalink;}.bind(this));}h.prototype.setClientHasAll=function(i){};h.prototype.addOrUpdateComment=function(i){if(i.__typename==='local'){this.$UFIPagedCommentListImpl1(i.id);}else this.$UFIPagedCommentListImpl2(i.id,i.clientid,i.legacyid);c('UFICentralUpdates').didUpdateFeedback(this.feedbackTargetID);};h.prototype.$UFIPagedCommentListImpl1=function(i){this.dataSource.setResource(this.count,i);this.count++;};h.prototype.$UFIPagedCommentListImpl2=function(i,j,k){var l=j&&c('ClientIDs').isExistingClientID(j),m=this.dataSource.getAllResources(),n={};for(var o in m){var p=m[o];n[p]=o;}if(l&&j&&j in n){n[i]=n[j];var q=n[j];this.dataSource.setResource(q,i);if(c('UFIConfig').logCommentPost)c('UFICommentLogger').logNewCommentReceived(j,Date.now());}else if(!n[i]&&j)this.$UFIPagedCommentListImpl1(i);if(k&&i in n)this.commentPermalinks[i]=this.buildCommentPermalink(i,k,n[i]);};h.prototype.addCommentIDs=function(i,j,k){var l={};for(var m=0;m<j;m++)l[i+m]=k[m]||c('UFIConstants').unavailableCommentKey;this.dataSource.addResourcesAndExecute(l);c('UFICentralUpdates').didUpdateFeedback(this.feedbackTargetID);};h.prototype.getComments=function(i,j,k,l){var m=new Array(j).fill().map(function(s,t){return t+i;}),n=this.dataSource.getUnavailableResourcesFromRequest(m);if(n.length){var o=Math.min.apply(Math,n),p=Math.max.apply(Math,n),q=o,r=p-o+1;if(q<this.lastRequestedOffset||q+r>this.lastRequestedOffset+this.lastRequestedLength){this.lastRequestedOffset=q;this.lastRequestedLength=r;this.fetchComments(q,r,k);}}else this.dataSource.executeOrEnqueue(m,function(s){return l(this.commentsFromCommentIDs(s,i,j));}.bind(this));};h.prototype.getCommentsOrThrow=function(i){var j=i.getLength(),k=i.getOffset(),l={};new Array(j).fill().forEach(function(m,n){var o=n+k,p=this.dataSource.getResource(o);if(!p)throw new Error('Tried to get nonexistent comment');l[o]=p;}.bind(this));return this.commentsFromCommentIDs(l,k,j);};h.prototype.fetchComments=function(i,j,k){};h.prototype.commentsFromCommentIDs=function(i,j,k){return {};};h.prototype.reset=function(){var i=this.dataSource.getAllResources();this.dataSource.reset();this.count=0;this.deletedCount=0;this.deletedComments={};this.lastRequestedOffset=0;this.lastRequestedLength=0;return i;};h.prototype.deleteComment=function(i){if(!(i in this.deletedComments)){this.deletedComments[i]=true;this.deletedCount++;}};h.prototype.updateCommentCount=function(i){this.count=i;this.deletedCount=0;};h.prototype.getFeedbackTargetID=function(){return this.feedbackTargetID;};h.prototype.getCommentCount=function(){return this.count;};h.prototype.getDeletedCount=function(){return this.deletedCount;};h.prototype.getDisplayedCommentCount=function(){return this.count-this.deletedCount;};h.prototype.getBasePermalink=function(){return this.basePermalink;};h.prototype.buildCommentPermalink=function(i,j,k){return null;};h.prototype.getPermalinkForComment=function(i){return this.commentPermalinks[i];};f.exports=h;}),null);
__d('UFIReplyCommentListImpl',['ActorURI','JSLogger','MercuryServerDispatcher','UFICommentLogger','UFIComments','UFIConfig','UFIPagedCommentListImpl','URI'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('JSLogger').create('ufi_reply_comment_list');h=babelHelpers.inherits(k,c('UFIPagedCommentListImpl'));i=h&&h.prototype;function k(l,m,n){i.constructor.call(this,l);this.parentCommentID=m;this.containerOrderingMode=n;}k.prototype.fetchComments=function(l,m,n){if(c('UFIConfig').logCommentLoad)c('UFICommentLogger').logCommentFetch(this.feedbackTargetID,Date.now(),{request_length:m,is_reply:true});var o={ft_ent_identifier:this.feedbackTargetID,parent_comment_ids:[this.parentCommentID],source:null,offsets:[l],lengths:[m],feed_context:n?n.feedContext:null,numpagerclicks:n?n.numPagerClicks:null,containerorderingmode:this.containerOrderingMode,translate_all:n?n.translateAll:null};if(!n||!n.viewAs)o[c('ActorURI').PARAMETER_ACTOR]=this.actorID;c('MercuryServerDispatcher').trySend('/ajax/ufi/reply_fetch.php',o);};k.prototype.commentsFromCommentIDs=function(l,m,n){var o={};for(var p=0;p<n;p++){var q=c('UFIComments').getComment(l[m+p]);if(q)o[m+p]=q;}return o;};k.prototype.reset=function(){var l=i.reset.call(this),m={};for(var n in l){var o=l[n];m[o]=true;}c('UFIComments').resetComments(m);return l;};k.prototype.getParentCommentID=function(){return this.parentCommentID;};k.prototype.buildCommentPermalink=function(l,m,n){if(!this.basePermalink)return null;var o=this.getParentCommentID().split('_'),p=m;if(o.length===2){p=o[1];}else j.error('Bad reply comment ID: '+this.getParentCommentID());return new (c('URI'))(this.basePermalink).addQueryData({comment_id:p,reply_comment_id:m}).toString();};c('MercuryServerDispatcher').registerEndpoints({'/ajax/ufi/reply_fetch.php':{mode:c('MercuryServerDispatcher').IMMEDIATE}});f.exports=k;}),null);
__d('UFIReplyCommentList',['getObjectValues','UFICentralUpdates','UFIComments','UFIConstants','UFIReplyCommentListImpl'],(function a(b,c,d,e,f,g){'use strict';var h={},i={getCommentList:function k(l,m,n){if(!h[m])h[m]={};if(!h[m][n]){var o=new (c('UFIReplyCommentListImpl'))(l,m,n),p=i.getReplyListsForParentCommentID(String(m));if(p.length)o.updateCommentCount(p[0].getCommentCount());h[m][n]=o;}return h[m][n];},getReplyListsForParentCommentID:function k(l){return c('getObjectValues')(h[l]||{});},resetWithContext:function k(l,m,n,o){var p=h[m][o];if(!p)return;p.reset();p.actorID=n;}};function j(k){var l=c('UFIComments').getComment(k.commentid),m=l.id,n=l.parentcommentid;if(!n)return;if(l.status!==c('UFIConstants').UFIStatus.DELETED&&l.status!==c('UFIConstants').UFIStatus.FAILED_ADD)i.getReplyListsForParentCommentID(n).forEach(function(o){o.deleteComment(m);});}c('UFICentralUpdates').subscribe('update-actions',function(k,l){if(l.actions&&l.actions.length)for(var m=0;m<l.actions.length;m++){var n=l.actions[m];switch(n.actiontype){case c('UFIConstants').UFIActionType.DELETE_COMMENT:j(n);break;}}});c('UFICentralUpdates').subscribe('update-comment-lists',function(k,l){var m=l.commentlists;if(m&&m.replies&&Object.keys(m).length)for(var n in m.replies){var o=m.replies[n],p=o.ftentidentifier,q=o.containerorderingmode,r=i.getCommentList(String(p),String(n),q);r.addCommentIDs(o.range.offset,o.range.length,o.values);r.updateCommentCount(o.count);}});c('UFICentralUpdates').subscribe('update-comments',function(k,l){if(l.comments&&l.comments.length)l.comments.forEach(function(m){var n=m.parentcommentid;if(!n)return;i.getReplyListsForParentCommentID(String(n)).forEach(function(o){o.addOrUpdateComment(m);});});});f.exports=i;}),22);
__d('UFIToplevelPagedCommentListImpl',['ActorURI','MercuryServerDispatcher','UFICommentLogger','UFIComments','UFIConfig','UFIOrderingModeStore','UFIPagedCommentListImpl','URI','WebCommentViewOption'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('UFIPagedCommentListImpl'));i=h&&h.prototype;function j(k,l){i.constructor.call(this,k);this.clientHasAll=false;this.orderReversed=c('UFIOrderingModeStore').isInverted(l);this.orderingMode=l;this.clientHasAll=false;}j.prototype.fetchComments=function(k,l,m){if(c('UFIConfig').logCommentLoad)c('UFICommentLogger').logCommentFetch(this.feedbackTargetID,Date.now(),{request_length:l,is_reply:false});var n={ft_ent_identifier:this.feedbackTargetID,viewas:m&&m.viewAs?m.viewAs+'':null,source:m&&m.feedbackSource,offset:k,length:l,orderingmode:this.orderingMode,feed_context:m?m.feedContext:null,numpagerclicks:m?m.numPagerClicks:null,translate_all:m?m.translateAll:null,clientcommentcount:this.count};if(this.orderingMode!==c('WebCommentViewOption').RECENT_ACTIVITY||this.orderingMode!==c('WebCommentViewOption').RANKED_THREADED||this.orderingMode!==c('WebCommentViewOption').FILTERED)delete n.clientcommentcount;if(!m||!m.viewAs)n[c('ActorURI').PARAMETER_ACTOR]=this.actorID;c('MercuryServerDispatcher').trySend('/ajax/ufi/comment_fetch.php',n);};j.prototype.commentsFromCommentIDs=function(k,l,m){var n={},o=l,p=l+m-1;for(var q=0;q<m;q++){var r=this.orderReversed?p-q:o+q,s=c('UFIComments').getComment(k[r]);if(s)n[l+q]=s;}return n;};j.prototype.getOrderingMode=function(){return this.orderingMode;};j.prototype.setClientHasAll=function(k){this.clientHasAll=k;};j.prototype.getClientHasAll=function(){return this.clientHasAll;};j.prototype.buildCommentPermalink=function(k,l,m){if(!this.basePermalink)return null;return new (c('URI'))(this.basePermalink).addQueryData({comment_id:l}).toString();};c('MercuryServerDispatcher').registerEndpoints({'/ajax/ufi/comment_fetch.php':{mode:c('MercuryServerDispatcher').IMMEDIATE}});f.exports=j;}),null);
__d('UFIToplevelStreamedCommentList',['invariant','ClientIDs','Map','UFICentralUpdates','UFICommentLogger','UFIConfig','UFIComments','UFIConstants','UFIRange','UFIStreamingStateType'],(function a(b,c,d,e,f,g,h){'use strict';function i(j){this.feedbackTargetID=j;this.commentIDs=[];this.deletedCount=0;this.totalCommentCount=0;}i.prototype.getFeedbackTargetID=function(){return this.feedbackTargetID;};i.prototype.getClientHasAll=function(){return false;};i.prototype.getActualCommentCount=function(){return this.commentIDs.length;};i.prototype.getCommentCount=function(){return this.totalCommentCount;};i.prototype.getDisplayedCommentCount=function(){return this.getCommentCount()-this.getDeletedCount();};i.prototype.getDeletedCount=function(){return this.deletedCount;};i.prototype.getPermalinkForComment=function(j){return '';};i.prototype.getComments=function(j,k,l,m){m(this.getCommentsOrThrow(new (c('UFIRange'))(j,k),l));};i.prototype.getCommentsOrThrow=function(j,k){var l=j.getLength(),m=j.getOffset();m===0||h(0);var n=k.streamingOrderReversed,o={};for(var p=0;p<Math.min(l,this.commentIDs.length);++p){var q=n?this.commentIDs.length-1-p:p,r=c('UFIComments').getComment(this.commentIDs[q]);if(r)o[p]=r;}return o;};i.prototype.$UFIToplevelStreamedCommentList3=function(){var j=this.commentIDs;this.commentIDs=[];return j;};i.prototype.hasComment=function(j){for(var k=0;k<this.commentIDs.length;++k)if(this.commentIDs[k]===j.id)return true;return false;};i.prototype.addCommentIDs=function(j,k,l){};i.prototype.setClientHasAll=function(j){};i.prototype.addOrUpdateComment=function(j){var k=arguments.length<=1||arguments[1]===undefined?null:arguments[1],l=j.clientid;if(l&&c('ClientIDs').isExistingClientID(l)){for(var m=0;m<this.commentIDs.length;++m)if(this.commentIDs[m]===l){this.commentIDs[m]=j.id;if(c('UFIConfig').logCommentPost)c('UFICommentLogger').logNewCommentReceived(l,Date.now());}}else if(k||j.__typename==='local'){if(this.hasComment(j))return;this.commentIDs.push(j.id);if(k!==c('UFIStreamingStateType').ON_DEMAND)this.totalCommentCount+=1;}if(this.commentIDs.length>50)this.commentIDs.shift();c('UFICentralUpdates').didUpdateFeedback(this.feedbackTargetID);};i.prototype.deleteComment=function(j){this.deletedCount+=1;var k=[];for(var l=0;l<this.commentIDs.length;++l){var m=this.commentIDs[l];if(m!==j)k.push(m);}this.commentIDs=k;};i.prototype.updateCommentCount=function(j){this.totalCommentCount=j;this.deletedCount=0;};i.getCommentList=function(j){var k=arguments.length<=1||arguments[1]===undefined?i.GLOBAL_ID:arguments[1],l=i.$UFIToplevelStreamedCommentList1.get(j);if(!l){l=new (c('Map'))();i.$UFIToplevelStreamedCommentList1.set(j,l);}var m=l.get(k);if(!m){m=new i(j);l.set(k,m);}return m;};i.getExistingCommentList=function(j){var k=arguments.length<=1||arguments[1]===undefined?i.GLOBAL_ID:arguments[1],l=i.$UFIToplevelStreamedCommentList1.get(j);if(!l)return null;return l.get(k);};i.getAllExistingCommentLists=function(j){var k=i.$UFIToplevelStreamedCommentList1.get(j);if(!k)return [];return Array.from(k.values());};i.$UFIToplevelStreamedCommentList4=function(j,k){var l=i.$UFIToplevelStreamedCommentList2.get(j);if(l){k.forEach(function(n){l[n]=true;});return;}var m={};k.forEach(function(n){m[n]=true;});i.$UFIToplevelStreamedCommentList2.set(j,m);};i.resetCommentList=function(j){var k=arguments.length<=1||arguments[1]===undefined?i.GLOBAL_ID:arguments[1],l=i.getExistingCommentList(j,k);if(!l)return;i.$UFIToplevelStreamedCommentList4(j,l.$UFIToplevelStreamedCommentList3());};i.resetAllCommentLists=function(j){var k=i.getAllExistingCommentLists(j);if(k.length===0)return;k.forEach(function(m){i.$UFIToplevelStreamedCommentList4(j,m.$UFIToplevelStreamedCommentList3());});var l=i.$UFIToplevelStreamedCommentList2.get(j);if(l){i.$UFIToplevelStreamedCommentList2['delete'](j);c('UFIComments').resetComments(l);}};i.GLOBAL_ID='GLOBAL_ID';i.$UFIToplevelStreamedCommentList1=new (c('Map'))();i.$UFIToplevelStreamedCommentList2=new (c('Map'))();c('UFICentralUpdates').subscribe('update-actions',function(j,k){if(!k.actions)return;k.actions.forEach(function(l){if(l.actiontype!==c('UFIConstants').UFIActionType.DELETE_COMMENT)return;var m=c('UFIComments').getComment(l.commentid),n=m.id,o=m.ftentidentifier,p=m.parentcommentid;if(p)return;if(l.islocal||m.status!==c('UFIConstants').UFIStatus.DELETED&&m.status!==c('UFIConstants').UFIStatus.FAILED_ADD)i.getAllExistingCommentLists(o).forEach(function(q){return q.deleteComment(n);});});});c('UFICentralUpdates').subscribe('update-comments',function(j,k){if(!k.comments)return;var l=k.targetufiinstanceid;k.comments.forEach(function(m){if(m.parentcommentid)return;if(l){i.getCommentList(m.ftentidentifier,l).addOrUpdateComment(m,k.streamingstate);}else i.getAllExistingCommentLists(m.ftentidentifier).forEach(function(n){n.addOrUpdateComment(m,k.streamingstate);});});});c('UFICentralUpdates').subscribe('update-feedback',function(j,k){var l=k.feedbacktarget?k.feedbacktarget:k.feedbacktargets&&k.feedbacktargets[0];if(!l)return;i.getAllExistingCommentLists(l.entidentifier).forEach(function(m){return m.updateCommentCount(l.commentcount);});});f.exports=i;}),22);
__d('UFIToplevelPagedCommentList',['UFICentralUpdates','UFIComments','UFIConstants','UFIReplyCommentList','UFIToplevelPagedCommentListImpl','UFIToplevelStreamedCommentList','WebCommentViewOption'],(function a(b,c,d,e,f,g){'use strict';var h={},i={getCommentList:function k(l,m){if(!h[l])h[l]={};if(!h[l][m]){var n=new (c('UFIToplevelPagedCommentListImpl'))(l,m),o=i.getCommentListsForFeedbackTargetID(l);if(o.length)n.updateCommentCount(o[0].getCommentCount());h[l][m]=n;}return h[l][m];},getCommentListsForFeedbackTargetID:function k(l){var m=[],n=h[l]||{};for(var o in n)m.push(n[o]);return m;},getPagedCommentCountForFeedbackTargetID:function k(l){var m=i.getCommentListsForFeedbackTargetID(l);return m.length?m[0].getCommentCount():null;},getDisplayedCommentCountForFeedbackTargetID_UNSAFE:function k(l){var m=i.getCommentListsForFeedbackTargetID(l),n=m.length?m[0].getDisplayedCommentCount():null,o=c('UFIToplevelStreamedCommentList').getAllExistingCommentLists(l),p=o.length?o[0].getDisplayedCommentCount():null;if(n===null&&p===null)return null;return Math.max(n||0,p||0);},resetCommentListsForFeedbackTargetID:function k(l){if(!h[l])return;var m={};for(var n in h[l]){var o=h[l][n],p=o.reset();for(var q in p){var r=p[q];m[r]=true;}}c('UFIComments').resetComments(m);},resetCommentListsWithContext:function k(l,m){var n=h[l];if(!n)return;var o={};for(var p in n){var q=n[p];q.actorID=m;var r=q.reset();for(var s in r){var t=r[s];o[t]=true;c('UFIReplyCommentList').resetWithContext(l,t,m,p);}}c('UFIComments').resetComments(o);}};function j(k){var l=c('UFIComments').getComment(k.commentid),m=l.id,n=l.ftentidentifier,o=l.parentcommentid;if(o)return;if(k.islocal||l.status!==c('UFIConstants').UFIStatus.DELETED&&l.status!==c('UFIConstants').UFIStatus.FAILED_ADD)i.getCommentListsForFeedbackTargetID(n).forEach(function(p){p.deleteComment(m);});}c('UFICentralUpdates').subscribe('update-actions',function(k,l){if(l.actions&&l.actions.length)for(var m=0;m<l.actions.length;m++){var n=l.actions[m];switch(n.actiontype){case c('UFIConstants').UFIActionType.DELETE_COMMENT:j(n);break;}}});c('UFICentralUpdates').subscribe('update-comment-lists',function(k,l){var m=l.commentlists;if(m&&m.comments&&Object.keys(m).length)for(var n in m.comments)for(var o in m.comments[n]){var p=m.comments[n][o],q=i.getCommentList(String(n),o);q.addCommentIDs(p.range.offset,p.range.length,p.values);q.setClientHasAll(!!p.forcenotpageable);}});c('UFICentralUpdates').subscribe('update-comments',function(k,l){if(l.comments&&l.comments.length)l.comments.forEach(function(m){if(m.parentcommentid)return;var n=m.ftentidentifier;i.getCommentListsForFeedbackTargetID(String(n)).forEach(function(o){o.addOrUpdateComment(m);});});});c('UFICentralUpdates').subscribe('update-feedback',function(k,l){var m,n=l.feedbacktarget?l.feedbacktarget:l.feedbacktargets&&l.feedbacktargets[0];if(n)(function(){var o=n.entidentifier,p=n.defaultcommentorderingmode,q={};if(p)q[p]=true;if(n.orderingmodes)n.orderingmodes.forEach(function(s){if(s.value===c('WebCommentViewOption').LIVE_STREAMING)return;q[s.value]=true;});for(var r in q)i.getCommentList(String(o),String(r)).updateCommentCount(n.commentcount);})();});f.exports=i;}),22);
__d("XConstituencyTitleEditVisibilityDialogController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/constituency_title\/edit_comment_visibility\/",{ft_id:{type:"FBID",required:true},action_type:{type:"Enum",required:true,enumType:1},source:{type:"Enum",required:true,enumType:1},comment_id:{type:"String"},__asyncDialog:{type:"Int"}});}),null);
__d("XConstituencyTitleEnableController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/constituency_title\/enable\/",{});}),null);
__d("XUFIActorChangeController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ufi\/actor\/change\/",{});}),null);
__d("XUFIAddCommentController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ufi\/add\/comment\/",{});}),null);
__d("XUFICommentAcceptAnswerController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ufi\/comment\/answer\/accept\/",{});}),null);
__d("XUFICommentLikeController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ufi\/comment\/like\/",{});}),null);
__d("XUFIDeleteCommentController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ufi\/delete\/comment\/",{});}),null);
__d("XUFIEditCommentController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ufi\/edit\/comment\/",{});}),null);
__d("XUFIHideCommentController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ufi\/hide\/comment\/",{});}),null);
__d("XUFILikeController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ufi\/like\/",{});}),null);
__d("XUFITranslateCommentController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ufi\/translate\/comment\/",{});}),null);
__d('UFIUserActions',['errorCode','fbt','ActorURI','AsyncRequest','AsyncResponse','Bootloader','ChannelClientID','ClientIDs','CommentPostedLiveState','ImmutableObject','UFICentralUpdates','UFIToplevelPagedCommentList','UFIToplevelStreamedCommentList','UFIComments','UFICommentLogger','UFIConfig','UFIConstants','UFIFeedbackTargets','UFIReactionUserActions','UFIUserActionUtils','UFIVideoPlayerRegistry','MercuryServerDispatcher','UnicodeBidi','XConstituencyTitleEditVisibilityDialogController','XConstituencyTitleEnableController','XUFIActorChangeController','XUFIAddCommentController','XUFICommentAcceptAnswerController','XUFICommentKeepSpamController','XUFICommentLikeController','XUFIDeleteCommentController','XUFIEditCommentController','XUFIHideCommentController','XUFILikeController','XUFITranslateCommentController','ifRequired'],(function a(b,c,d,e,f,g,h,i){'use strict';var j={BAN:'ban',UNDO_BAN:'undo_ban'},k={changeActor:function ia(ja,ka){c('UFIFeedbackTargets').getFeedbackTarget(ja,function(la){c('UFIToplevelPagedCommentList').resetCommentListsWithContext(ja,ka);c('UFIToplevelStreamedCommentList').resetAllCommentLists(ja);c('UFICentralUpdates').inform('actor-changed',{actorID:ka});var ma={from_actor_id:la.actorforpost,ft_ent_identifier:ja};ma[c('ActorURI').PARAMETER_ACTOR]=ka;var na=c('XUFIActorChangeController').getURIBuilder().getURI();c('MercuryServerDispatcher').trySend(na,ma);});},changeCommentLike:function ia(ja,ka,la){var ma,na=c('UFIComments').getComment(ja);if(na.hasviewerliked!=ka)(function(){var oa=la.target?c('UFIUserActionUtils').trackingData(la.target):{},pa=ka?1:-1,qa={commentid:ja,actiontype:c('UFIConstants').UFIActionType.COMMENT_LIKE,viewerliked:ka,likecount:(na.likecount||0)+pa};c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{actions:[qa]});c('UFIFeedbackTargets').getFeedbackTarget(na.ftentidentifier,function(ra){var sa={};sa[c('ActorURI').PARAMETER_ACTOR]=ra.actorforpost;var ta=c('XUFICommentLikeController').getURIBuilder().getURI();c('MercuryServerDispatcher').trySend(ta,babelHelpers['extends']({comment_id:ja,legacy_id:na.legacyid,like_action:ka,ft_ent_identifier:na.ftentidentifier,source:la.source,client_id:c('ClientIDs').getNewClientID(),session_id:c('ChannelClientID').getID()},oa,sa));});})();},_getAttachment:function ia(ja){return ja;},_getLocalComment:function ia(ja,ka,la,ma,na,oa){var pa=c('ClientIDs').getNewClientID(),qa=c('UnicodeBidi').isDirectionLTR(la)?'ltr':'rtl',ra=this._getAttachment(na.attachedsticker);return {__typename:'local',ftentidentifier:ka,body:{text:la,dir:qa},author:ja.actorforpost,cancomment:false,clientid:null,fbid:null,id:pa,ufiinstanceid:na.ufiinstanceid,likecount:0,hasviewerliked:false,parentcommentid:na.replyid,replycommentparentid:na.replycommentparentid,attachment:ra,photo_comment:na.attachedphoto,video_comment:na.attachedvideo,timestamp:{time:Math.floor(Date.now()/1000),text:i._("a few seconds ago")},photoTextTagID:na.photoTextTagID,isPhotoTag:na.isPhotoTag,photoTagX:na.photoTagX,photoTagY:na.photoTagY,videoTimeOffset:oa,postedLiveState:na.islivestreaming?c('CommentPostedLiveState').LIVE:c('CommentPostedLiveState').ON_DEMAND};},addComment:function ia(ja,ka,la,ma){c('UFIFeedbackTargets').getFeedbackTarget(ja,function(na){var oa=this.createComment(ja,ka,la,ma);if(!oa)return;var pa={actiontype:c('UFIConstants').UFIActionType.SUBSCRIBE_ACTION,actorid:na.actorforpost,hasviewersubscribed:true,entidentifier:na.entidentifier},qa={actiontype:c('UFIConstants').UFIActionType.ADD_COMMENT_ACTION,feedbackfbid:na.targetfbid};c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{comments:[oa],actions:[pa,qa]});}.bind(this));},createComment:function ia(ja,ka,la,ma){var na=c('UFIFeedbackTargets').getFeedbackTargetIfExists(ja);if(!na.actorforpost)return null;var oa=null;if(ma.isBroadcasterUFI){oa=c('ifRequired')('LiveVideoBroadcastBroadcastStore',function(sa){return sa.getCurrentBroadcastTime();});}else if(ma.fluentContentToken&&(ma.isLiveVOD||ma.islivestreaming||ma.enableVODCommentTimestamps)){var pa=c('UFIVideoPlayerRegistry').getAvailableVideoPlayerControllerTimeForElement(ma.target,ma.fluentContentToken)||0;if(ma.isLiveVOD||ma.islivestreaming){oa=pa;}else{var qa=c('UFIVideoPlayerRegistry').getAvailableVideoPlayerControllerForElement(ma.target,ma.fluentContentToken);if(qa!=null&&pa>0&&pa<Math.floor(qa.getPlaybackDuration()))oa=pa;}}var ra=this._getLocalComment(na,ja,ka,la,ma,oa);this._sendCommentToServer(ja,na.actorforpost,ka,la,ma,ra.id,oa);return ra;},_sendCommentToServer:function ia(ja,ka,la,ma,na,oa,pa){var qa=null;if(na.reply_fbid){qa=na.reply_fbid;}else if(na.replyid)qa=c('UFIComments').getComment(na.replyid).fbid;var ra=void 0;if(c('UFIConfig').logCommentPost)c('UFICommentLogger').logNewCommentPost(oa,na.timestamp||0,{has_photo:!!na.attachedphoto,has_video:!!na.attachedvideo,has_sticker:!!na.attachedsticker,is_reply:!!na.replyid});var sa={};sa[c('ActorURI').PARAMETER_ACTOR]=ka;var ta=c('XUFIAddCommentController').getURIBuilder().getURI();c('MercuryServerDispatcher').trySend(ta,babelHelpers['extends']({ft_ent_identifier:ja,comment_text:ma,source:na.source,client_id:oa,session_id:c('ChannelClientID').getID(),reply_fbid:qa,parent_comment_id:na.parent_comment_id||na.replyid,reply_comment_parent_id:na.replycommentparentid,rootid:na.rootid,clp:ra,attached_sticker_fbid:na.attachedsticker?na.attachedsticker.fbid:0,attached_photo_fbid:na.attachedphoto?na.attachedphoto.fbid:0,attached_video_fbid:na.attachedvideo?na.attachedvideo.fbid:0,attached_share_url:na.attachedshareurl,feedback_referrer:na.feedbackReferrer,feed_context:na.feedcontext,video_time_offset:pa,is_live_streaming:na.islivestreaming,is_markdown:na.isMarkdown},c('UFIUserActionUtils').trackingData(na.target),sa,{photo_text_tag_id:na.photoTextTagID,is_private:na.isPrivate,is_photo_tag:na.isPhotoTag,photo_fbid:na.photoFBID,photo_tag_x:na.photoTagX,photo_tag_y:na.photoTagY}));},_hasCommentTextChanged:function ia(ja,ka){return !!ja.body&&ja.body.text!=ka;},_hasCommentPhotoChanged:function ia(ja,ka){return !!((ja||ka)&&!(ja&&ka)||ja&&ka&&ja.fbid!=ka.fbid);},_hasCommentVideoChanged:function ia(ja,ka){return !!((ja||ka)&&!(ja&&ka)||ja&&ka&&ja.fbid!=ka.fbid);},_hasCommentStickerChanged:function ia(ja,ka){return !!((ja||ka)&&!(ja&&ka)||ja&&ja.type=='sticker'&&ka&&ja.fbid!=ka.fbid);},_hasCommentShareURLChanged:function ia(ja,ka){if(ka){return true;}else return ja&&ja.type=='share';},editComment:function ia(ja,ka,la,ma){var na=c('UFIUserActionUtils').trackingData(ma.target),oa=c('UFIComments').getComment(ja),pa=this._hasCommentTextChanged(oa,ka)||this._hasCommentPhotoChanged(oa.photo_comment,ma.attachedPhoto)||this._hasCommentStickerChanged(oa.attachment,ma.attachedSticker)||this._hasCommentVideoChanged(oa.video_comment,ma.attachedVideo)||this._hasCommentShareURLChanged(oa.attachment,ma.attachedShareURL);oa=c('ImmutableObject').set(oa,{status:c('UFIConstants').UFIStatus.PENDING_EDIT,body:{text:ka},editnux:null,attachment:ma.attachedSticker,photo_comment:ma.attachedPhoto,video_comment:ma.attachedVideo});if(pa)oa=c('ImmutableObject').set(oa,{originalTimestamp:oa.timestamp.time,timestamp:{time:Math.floor(Date.now()/1000),text:i._("a few seconds ago")}});c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{comments:[oa]});c('UFIFeedbackTargets').getFeedbackTarget(oa.ftentidentifier,function(qa){var ra={};ra[c('ActorURI').PARAMETER_ACTOR]=qa.actorforpost;var sa=c('XUFIEditCommentController').getURIBuilder().getURI();c('MercuryServerDispatcher').trySend(sa,babelHelpers['extends']({ft_ent_identifier:oa.ftentidentifier,comment_text:la,source:ma.source,comment_id:oa.id,parent_comment_id:oa.parentcommentid,attached_sticker_fbid:ma.attachedSticker?ma.attachedSticker.fbid:0,attached_photo_fbid:ma.attachedPhoto?ma.attachedPhoto.fbid:0,attached_video_fbid:ma.attachedVideo?ma.attachedVideo.fbid:0,attached_share_url:ma.attachedShareURL},na,ra));});},translateComments:function ia(ja,ka,la,ma){var na=c('XUFITranslateCommentController').getURIBuilder().getURI();c('MercuryServerDispatcher').trySend(na,{ft_ent_identifier:ja,comment_ids:ka,source:ma.source,trigger:la});},setHideAsSpam:function ia(ja,ka,la){var ma=c('UFIUserActionUtils').trackingData(la.target),na=c('UFIComments').getComment(ja),oa={commentid:ja,actiontype:c('UFIConstants').UFIActionType.COMMENT_SET_SPAM,shouldHideAsSpam:ka};c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{actions:[oa]});c('UFIFeedbackTargets').getFeedbackTarget(na.ftentidentifier,function(pa){var qa={};qa[c('ActorURI').PARAMETER_ACTOR]=pa.actorforpost;var ra=c('XUFIHideCommentController').getURIBuilder().getURI();c('MercuryServerDispatcher').trySend(ra,babelHelpers['extends']({comment_id:ja,spam_action:ka,ft_ent_identifier:na.ftentidentifier,source:la.source},ma,qa));});},keepSpam:function ia(ja,ka){var la=c('UFIUserActionUtils').trackingData(ka.target),ma=c('UFIComments').getComment(ja),na={commentid:ja,actiontype:c('UFIConstants').UFIActionType.COMMENT_KEEP_SPAM};c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{actions:[na]});c('UFIFeedbackTargets').getFeedbackTarget(ma.ftentidentifier,function(oa){var pa={};pa[c('ActorURI').PARAMETER_ACTOR]=oa.actorforpost;var qa=c('XUFICommentKeepSpamController').getURIBuilder().getURI();c('MercuryServerDispatcher').trySend(qa,babelHelpers['extends']({comment_id:ja,ft_ent_identifier:ma.ftentidentifier,source:ka.source},la,pa));c('Bootloader').loadModules(["SimpleXUIDialog"],function(ra){ra.show(i._("This comment is now visible on your post."),i._("Comment Restored"));},'UFIUserActions');});},removeComment:function ia(ja,ka){var la=c('UFIUserActionUtils').trackingData(ka.target),ma=c('UFIComments').getComment(ja),na={actiontype:c('UFIConstants').UFIActionType.DELETE_COMMENT,commentid:ja,islocal:true,oneclick:ka.oneclick};c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{actions:[na]});c('UFIFeedbackTargets').getFeedbackTarget(ma.ftentidentifier,function(oa){var pa={};pa[c('ActorURI').PARAMETER_ACTOR]=oa.actorforpost;var qa=c('XUFIDeleteCommentController').getURIBuilder().getURI();c('MercuryServerDispatcher').trySend(qa,babelHelpers['extends']({comment_id:ma.id,comment_legacyid:ma.legacyid,ft_ent_identifier:ma.ftentidentifier,one_click:ka.oneclick,source:ka.source,client_id:c('ClientIDs').getNewClientID()},la,pa));});},changeAcceptedAnswer:function ia(ja,ka){c('MercuryServerDispatcher').trySend(x,{ft_ent_identifier:ja.id,do_accept:ka});},banUser:function ia(ja,ka,la,ma){var na=la?j.BAN:j.UNDO_BAN;c('MercuryServerDispatcher').trySend('/ajax/ufi/ban_user.php',{page_id:ka,commenter_id:ja.author,action:na,comment_id:ja.id,client_side:true});},changeSubscribe:function ia(ja,ka,la){c('UFIFeedbackTargets').getFeedbackTarget(ja,function(ma){var na=c('UFIUserActionUtils').trackingData(la.target);if(ma.hasviewersubscribed!==ka){var oa={actiontype:c('UFIConstants').UFIActionType.SUBSCRIBE_ACTION,actorid:ma.actorforpost,hasviewersubscribed:ka,entidentifier:ja};c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{actions:[oa]});var pa={};pa[c('ActorURI').PARAMETER_ACTOR]=ma.actorforpost;c('MercuryServerDispatcher').trySend('/ajax/ufi/subscribe.php',babelHelpers['extends']({subscribe_action:ka,ft_ent_identifier:ja,source:la.source,client_id:c('ClientIDs').getNewClientID(),rootid:la.rootid,comment_expand_mode:la.commentexpandmode},na,pa));}});},fetchSpamComments:function ia(ja,ka,la,ma){c('MercuryServerDispatcher').trySend('/ajax/ufi/id_comment_fetch.php',{ft_ent_identifier:ja,viewas:ma,comment_ids:ka,parent_comment_id:la,source:null});},hideConstituentTitle:function ia(ja){var ka=c('XConstituencyTitleEnableController').getURIBuilder().getURI();new (c('AsyncRequest'))(ka).setMethod('POST').setData({ft_id:ja.ftentidentifier,enable:false,source:'comment_edit_menu',comment_id:ja.id}).send();},showConstituentTitle:function ia(ja){var ka=c('XConstituencyTitleEditVisibilityDialogController').getURIBuilder().setFBID('ft_id',ja.ftentidentifier).setEnum('action_type','comment_show_constituent_title').setEnum('source','comment_edit_menu').setString('comment_id',ja.id).getURI();new (c('AsyncRequest'))(ka).send();},removePreview:function ia(ja,ka){var la=c('UFIUserActionUtils').trackingData(ka.target),ma={commentid:ja.id,actiontype:c('UFIConstants').UFIActionType.REMOVE_PREVIEW};c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{actions:[ma]});c('MercuryServerDispatcher').trySend('/ajax/ufi/remove_preview.php',babelHelpers['extends']({comment_id:ja.id,ft_ent_identifier:ja.ftentidentifier,source:ka.source},la));}};function l(ia){c('AsyncResponse').defaultErrorHandler(ia);}function m(ia){var ja=ia.request.data;c('AsyncResponse').defaultErrorHandler(ia);var ka=ja.client_id||ja.comment_id,la=c('UFIComments').getComment(ka),ma=la.status===c('UFIConstants').UFIStatus.PENDING_EDIT?c('UFIConstants').UFIStatus.FAILED_EDIT:c('UFIConstants').UFIStatus.FAILED_ADD;la=c('ImmutableObject').setDeep(la,{status:ma,allowRetry:n(ia),body:{mentionstext:ja.comment_text,mentionsphoto:la.photo_comment,mentionsvideo:la.video_comment}});c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{comments:[la]});}function n(ia){var ja=ia.getError();if(ia.isBlockedAction())return false;if(ia.silentError)return true;if(ja===1357012||ja===1357006)return false;return true;}function o(ia){var ja=ia.request.data,ka=ja.comment_id,la=c('UFIComments').getComment(ka);la=c('ImmutableObject').set(la,{status:la.priorstatus||null,priorstatus:undefined});c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{comments:[la]});}function p(ia){var ja=ia.request.data,ka=ja.comment_id,la=c('UFIComments').getComment(ka);la=c('ImmutableObject').set(la,{commentid:ka,needsApproval:!la.needsApproval,isApproved:!la.isApproved});c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{comments:[la]});}function q(ia){var ja=ia.request.data,ka=ja.comment_id,la=c('UFIComments').getComment(ka);if(ja.like_action===la.hasviewerliked){var ma=la.hasviewerliked?-1:1,na={commentid:ka,actiontype:c('UFIConstants').UFIActionType.COMMENT_LIKE,viewerliked:!la.hasviewerliked,likecount:(la.likecount||0)+ma};c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{actions:[na]});}c('AsyncResponse').defaultErrorHandler(ia);}function r(ia){var ja=ia.request.data,ka=ja.ft_ent_identifier;c('UFIFeedbackTargets').getFeedbackTarget(ka,function(la){if(la.hasviewerliked===ja.like_action){var ma=la.hasviewerliked?-1:1,na={actiontype:c('UFIConstants').UFIActionType.LIKE_ACTION,actorid:la.actorforpost,hasviewerliked:!la.hasviewerliked,likecount:(la.likecount||0)+ma,entidentifier:ka,likesentences:{current:la.likesentences.alternate,alternate:la.likesentences.current}};c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{actions:[na]});}});c('AsyncResponse').defaultErrorHandler(ia);}function s(ia){var ja=ia.request.data,ka=ja.ft_ent_identifier;c('UFIFeedbackTargets').getFeedbackTarget(ka,function(la){if(la.hasviewersubscribed===ja.subscribe_action){var ma={actiontype:c('UFIConstants').UFIActionType.SUBSCRIBE_ACTION,actorid:la.actorforpost,hasviewersubscribed:!la.hasviewersubscribed,entidentifier:ka};c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.USER_ACTION,{actions:[ma]});}});c('AsyncResponse').defaultErrorHandler(ia);}var t={'/ajax/ufi/ban_user.php':{mode:c('MercuryServerDispatcher').IMMEDIATE,error_handler:l},'/ajax/ufi/subscribe.php':{mode:c('MercuryServerDispatcher').BATCH_CONDITIONAL,error_handler:s,batch_if:ga,batch_function:ha},'/ajax/ufi/id_comment_fetch.php':{mode:c('MercuryServerDispatcher').IMMEDIATE},'/ajax/ufi/remove_preview.php':{mode:c('MercuryServerDispatcher').IMMEDIATE},'/profile/broadcast_request/async/add_composer_token/':{mode:c('MercuryServerDispatcher').IMMEDIATE}},u=c('XUFIAddCommentController').getURIBuilder().getURI();t[u]={mode:c('MercuryServerDispatcher').IMMEDIATE,error_handler:m};var v=c('XUFIDeleteCommentController').getURIBuilder().getURI();t[v]={mode:c('MercuryServerDispatcher').IMMEDIATE,error_handler:o};var w=c('XUFICommentLikeController').getURIBuilder().getURI();t[w]={mode:c('MercuryServerDispatcher').BATCH_CONDITIONAL,error_handler:q,batch_if:ea,batch_function:ha};var x=c('XUFICommentAcceptAnswerController').getURIBuilder().getURI();t[x]={mode:c('MercuryServerDispatcher').IMMEDIATE};var y=c('XUFIHideCommentController').getURIBuilder().getURI();t[y]={mode:c('MercuryServerDispatcher').IMMEDIATE,error_handler:o};var z=c('XUFICommentKeepSpamController').getURIBuilder().getURI();t[z]={mode:c('MercuryServerDispatcher').IMMEDIATE,error_handler:p};var aa=c('XUFILikeController').getURIBuilder().getURI();t[aa]={mode:c('MercuryServerDispatcher').BATCH_CONDITIONAL,error_handler:r,batch_if:fa,batch_function:ha};var ba=c('XUFIEditCommentController').getURIBuilder().getURI();t[ba]={mode:c('MercuryServerDispatcher').IMMEDIATE,error_handler:m};var ca=c('XUFITranslateCommentController').getURIBuilder().getURI();t[ca]={mode:c('MercuryServerDispatcher').IMMEDIATE};var da=c('XUFIActorChangeController').getURIBuilder().getURI();t[da]={mode:c('MercuryServerDispatcher').IMMEDIATE};c('MercuryServerDispatcher').registerEndpoints(t);function ea(ia,ja){return ia&&ia.ft_ent_identifier==ja.ft_ent_identifier&&ia.comment_id==ja.comment_id;}function fa(ia,ja){return ia&&ia.ft_ent_identifier==ja.ft_ent_identifier;}function ga(ia,ja){return ia&&ia.ft_ent_identifier==ja.ft_ent_identifier;}function ha(ia,ja){return ja;}f.exports=babelHelpers['extends']({},k,c('UFIReactionUserActions'));}),null);
__d('UFISpamStore',['FluxReduceStore','UFIDispatcherBase','UFIStoryActionType','UFIUserActions'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('FluxReduceStore'));i=h&&h.prototype;j.prototype.getInitialState=function(){return {};};j.prototype.areEqual=function(k,l){return Object.keys(k).length===Object.keys(l).length;};j.prototype.reduce=function(k,l){switch(l.type){case c('UFIStoryActionType').SPAM_FETCHED:k=babelHelpers['extends']({},k);l.commentIDs.forEach(function(m){return k[m]=true;});c('UFIUserActions').fetchSpamComments(l.ftentidentifier,l.commentIDs,l.parentCommentID,l.viewas);break;}return k;};function j(){h.apply(this,arguments);}f.exports=new j(c('UFIDispatcherBase'));}),null);
__d('UFIInstanceAction',['UFIInstanceActionType'],(function a(b,c,d,e,f,g){'use strict';var h={changeOrderingMode:function i(j,k){return {type:c('UFIInstanceActionType').CHANGE_ORDER_MODE,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,mode:k};},toggleComments:function i(j){return {type:c('UFIInstanceActionType').TOGGLE_COMMENTS,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier};},changeCommentListVisibility:function i(j,k){return {type:c('UFIInstanceActionType').CHANGE_VISIBILITY,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,visibility:k};},init:function i(j,k){return {type:c('UFIInstanceActionType').INIT,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,payload:k};},didRequestVODComments:function i(j){return {type:c('UFIInstanceActionType').REQUESTED_VOD_COMMENTS,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier};},didReceiveVODComments:function i(j){return {type:c('UFIInstanceActionType').RECEIVED_VOD_COMMENTS,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier};},remove:function i(j){return {type:c('UFIInstanceActionType').REMOVE,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier};},toggleCommercialBreak:function i(j,k){return {type:c('UFIInstanceActionType').TOGGLE_COMMERCIAL_BREAK,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier,inCommercial:k};},translateAll:function i(j){return {type:c('UFIInstanceActionType').TRANSLATE_ALL,instanceID:j.instanceid,ftentidentifier:j.ftentidentifier};}};f.exports=h;}),null);
__d('linkifyEntityRange',['Link.react','React'],(function a(b,c,d,e,f,g){function h(i,j){var k=(j.entity||{}).url;if(!k)return c('React').createElement('span',null,i);return c('React').createElement(c('Link.react'),{href:k,target:'_blank'},i);}f.exports=h;}),null);
__d('CommentPrelude',['BanzaiODS','CSS','ErrorUtils','Parent','clickRefAction','ex','ifRequired'],(function a(b,c,d,e,f,g){function h(n,o){if(n==='ufi.react'||n==='ufi_mentions_input.react'||n==='ufi_controller'||n==='action_link_bling'||n==='action_link_timeline_bling')return;var p=new Error(c('ex')('Deprecated CommentPrelude action %s called from ref %s',o||'unknown',n||'unknown'));p.type='warn';c('ErrorUtils').reportError(p);c('BanzaiODS').bumpEntityKey('comment_prelude',n);}function i(n,o,p){h(p,'click');var q=c('Parent').byTag(n,'form');if(!q||!c('CSS').hasClass(q,'collapsible_comments'))return;c('clickRefAction')('ufi',n,null,'FORCE');return j(n,o,p);}function j(n,o,p){h(p,'expand');var q=c('Parent').byTag(n,'form');if(!q||!c('CSS').hasClass(q,'collapsible_comments'))return;k(q,p);if(o!==false){var r=q.add_comment_text_text||q.add_comment_text,s=r.length;if(s)if(!c('Parent').byClass(r[s-1],'UFIReplyList')){r=r[s-1];}else if(!c('Parent').byClass(r[0],'UFIReplyList')){r=r[0];}else r=null;if(r){r.focus();c('ifRequired')('FbFeedCommentUFIScroller',function(t){return t.reveal(r);});}}return false;}function k(n,o){h(o,'uncollapse');if(!n||!c('CSS').hasClass(n,'collapsible_comments'))return;var p=c('CSS').removeClass.bind(null,n,'collapsed_comments');c('ifRequired')('ScrollAwareDOM',function(q){return q.monitor(n,p);},function(){return p();});}function l(n){var o=n.getAttribute('data-comment-prelude-ref');h(o,'blingbox');var p=c('Parent').byTag(n,'form');if(!p||!c('CSS').hasClass(p,'collapsible_comments'))return;c('CSS').toggleClass(p,'collapsed_comments');}var m={click:i,expand:j,uncollapse:k,onBlingboxClick:l,logRef:h};f.exports=m;}),null);